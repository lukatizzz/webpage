<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> CAFE shop-Quanly</title>
    <!-- icon -->
    <link rel="stylesheet" href="../assets/fonts/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    
    <link rel="icon" type="image/x-icon" href="../assets/icon/belgium.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="../Common/style.css ">
    <link rel="stylesheet" href="../assets/css/main.css">

    <link rel="stylesheet" href="../assets/css/base.css">
    

   
  </head>
  <body>

  
      <!-- Nhúng bootstrap, jquery -->

     

      <!-- Header -->
     <div id="Header">  

    <!-- Action_bar -->
    <div id="Action_bar">
      <div >
        
          <div class="contact_details "  aria-label="contact_detail">          
            <li class="slogan">
             Đại Học Bách Khoa Hà Nội:  
              <a href="#">Trường Cơ Khí</a>
            </li>
          </div>
          <div class="social_menu ">
          
           <li> 
            <a href="">Our shop</a>
            </li>
           <li> 
            <a href=""> </a>
           </li>
           <li> <a href="">Help</a> </li>
          
          
          </div>
      


        
      </div>

    </div>

    <!-- Top_bar -->
    <div id="Top_bar">
      <div class= "container">
        <div class="logo">
          <div class="logo_image">
            <a  href="#">
              <img style="width:1080px ;height: 258px"; src="../assets/img/DATN/immage_Cafe/logo.png" alt="logo">
            </a>
          </div>  
  
        </div>
        <div id="buttn-nav__mobile" class="buttn-nav__mobile">
            <a href=""><i class="bi-justify-right"></i></a>
          </div>   
        <div class="menu"> 
           
          <nav class="navbar navbar-expand-lg navbar-light  ">
          
            <div" class="container-fluid">
              
              <button id="btn-nav__menu" class="navbar-toggler" type="button"  data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class=" navbar-nav m-auto navbar_menu ">
                  <a  class="nav-link" href="#">GIỚI THIỆU</a>
                  <a class="nav-link "  href="../assets/index.html">GỌI MÓN</a>
                  <a class="nav-link active" href="../assets/nhanvien.html">NHÂN VIÊN</a>
                  <a class="nav-link" href="#">BLOG</a>
                  
                  <a class="nav-link" href="#">HỎI ĐÁP</a>
                
                </div>

              </div>
            </div>
           
          </nav>
          
        </div>

      </div>
    


    </div>
    </div>

       <!-- Content -->
    <div  id="Content">
      <!--  3 hình ảnh đầu -->

     <div class="container banner">
      <div class="row">
        <div  style="background-color:#eef2f3;" class="col-sm-12 col-md-6 col-lg-8 ">
          <div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel">
            <ol class="carousel-indicators">
              <li  data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></li>
              <li data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></li>
             
            </ol>
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="10000">
                <img src="../assets/img/DATN/immage_Cafe/hinh-anh-cafe-1.jpg" class="d-block w-100" alt="...">
                
              </div>
              <div class="carousel-item" data-bs-interval="2000">
                <img style="max-height: 300x;" src="../assets/img/DATN/immage_Cafe/hinh-anh-ly-cafe-dep-19.jpg" class="d-block w-100" alt="...">
                
              </div>
             
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-4 ">
         
          <div class="row">

           <div class="select_age">
            <img src="../assets/img/DATN/immage_Cafe/ly-tach-va-hat-ca-phe.jpg" class="d-block w-100" alt="...">
            

            
             
           </div>

            
           
            
            
           
          </div>
          <div class="row">

            <div class="banner-cover">
              <div class="banner-age">
                <img class="img-fluid" src="../assets/img/DATN/immage_Cafe/hinh-anh-ly-cafe-dep-19.jpg" alt="">
                    
                
                <a href="#"><span class="font-bottom">CAFE CHILL</span></a>
  
              </div>
            </div>


            
          </div>
        </div>
        <!-- Hết 3 hình ảnh đầu -->
       
      </div>
      </div>


      <div class="trangtri"></div>

       <!--  -->
       <!-- type -->


     <!-- separeate -->
     <div class="separate">
      <div class="image-separate">
        <img src="../assets/img/web_home/babyshop-sep1-50x3.png" alt="">
      </div>
      <!-- <div class="texth3-separate">
        <h3>
          
          Welcome in our <span class="border-bottom-yellow">child's world.</span> <br>
         
          All our products are made
         <br> from generations with passion.
      
        </h3>
      </div> -->

      
     </div>
     <div class="BangQuanLy" style="justify-content: center;display:flex; align-items: center; " >
        <table>
            <tr>
              <th>Tên bàn</th>
              <th>Món ăn</th>
              <th>Tổng giá</th>
              <th>Xác nhận</th>
            </tr>
            <tr>
              <td>Bàn 1</td>
              <td id="food1"></td>
              <td id="price1"></td>
              <td><button onclick="xacnhan1(1)">XÁC NHẬN</button></td>
            </tr>
            <tr>
              <td >Bàn 2</td>
              <td id="food2"></td>
              <td id="price2"></td>
              <td><button onclick="xacnhan1(2)">XÁC NHẬN</button></td>
            </tr>
            <tr>
              <td >Bàn 3</td>
              <td id="food3"></td>
              <td id="price3"></td>
              <td><button onclick="xacnhan1(3)">XÁC NHẬN</button></td>
            </tr>
            <tr>
              <td >Bàn 4</td>
              <td id="food4"></td>
              <td id="price4"></td>
              <td><button onclick="xacnhan1(4)">XÁC NHẬN</button></td>
            </tr>
        </table>
     </div>
     <div class="btn_GiaoHang justify-content-center" style="display: flex; align-items:center;padding-bottom:500px;">
      <button class="btn btn-primary" onclick="giaodo1()">
        GiAO ĐỒ
      </button>
     </div>





     
     
     <!-- catalog -->

          <!-- Footer -->
     <div class="footer">
     <div class="container ">
        <div class="row ">
            <div class="col col-lg-3 col-md-6 col-12">
                <div class="footer-item">
                    <img class="logo" src="./img/DATN/immage_Cafe/logo.png" alt="">
                    <p class="paragraph">
                        In the BeFriends Club you can take advantage of attractive offers
                    </p>
    
                    <button class="btn">
                        JOIN NOW
                    </button>
    
                    <img class="card" src="./img/web_home/master-card.png" alt="">
                </div>
            </div>
            <div class="col col-lg-3 col-md-6 col-12">
                <div class="footer-item">
                    <div class="footer-item__container">
                        <h5 class="footer-item__container-heading">
                            Useful links
                        </h5>
                        <div class="footer-item__container-list">
                            <a href="#">Contact us</a>
                            <a href="#">Help & About us</a>
                            <a href="#">Shipping & Returns</a>
                            <a href="#">Refund Policy</a>
                        </div>
                    </div>
    
                    <div class="footer-item__container">
                        <h5 class="footer-item__container-heading">
                            Delivery
                        </h5>
                        <div class="footer-item__container-list">
                            <a href="#">How it Works</a>
                            <a href="#">Free Delivery</a>
                            <a href="#">FAQ</a>
                        </div>
                    </div>
    
                </div>
            </div>
            <div class="col col-lg-3 col-md-6 col-12">
                <div class="footer-item">
                    <div class="footer-item__container">
                        <h5 class="footer-item__container-heading">
                            Customer service
                        </h5>
                        <div class="footer-item__container-list">
                            <a href="#">Orders</a>
                            <a href="#">Downloads</a>
                            <a href="#">Addresses</a>
                            <a href="#">Account details</a>
                            <a href="#">Lost password</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col col-lg-3 col-md-6 col-12">
                <div class="footer-item last">
                    <div class="footer-item__container">
                        <h5 class="footer-item__container-heading">
                            Need help?
                        </h5>
                        <div class=" footer-list-number footer-item__container-list ">
                            <a href="tel:+61 (0) 383 766 284"><i class="bi-phone"></i>+61 (0) 383 766 284</a>
                            <a href="tel:+61 (0) 383 766 284"><i class="bi-phone"></i>+61 (0) 383 766 284</a>
                        </div>
                    </div>
                    <div style=" color:#6a717c "class="footer-item__container">
                        <h5 style="font-size:17px ;color:#6a717c ;" class="footer-item__container-heading">
                            Opening hours:
                        </h5>
                        <div class="footer-item__container-list">
                            <a href="#"><span style="color:#1a1e24 ;text-decoration-style:dotted;" class="date">Monday - Friday:</span> 8am - 5pm</a>
                            <a href="#"><span style="color:#1a1e24; text-decoration-style:dotted;"class="date">Saturday - Sunday:</span> 9am - 4pm</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer-2">
        <div class="container footer-low">
            <div class="row">
                <div class="col-lg-7 col-12 ">
                    <p class="content">© 2022 Betheme by <a href="#"> Muffin group</a> | All Rights Reserved | Powered by <a href="#">WordPress</a></p>
                </div>
                <div class="col-lg-5 col-12 ">
                    <div class="content">
                        <a href="#">Terms and conditions </a>
                        <a href="#">Privacy policy </a>
                        <a href="#">Cookies </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
     </div>
     <!-- side-bar -->
     <div id="site-bar-ovelay"  class=" overlay" ;>
        <div class="site-menu">
            <div id="menu-close" class="close">
                X
            </div> <br>

            <div class="list-icon">
                <a class="nav-link active" href=""><i class="ti-user"></i> </a>
                <a class="nav-link active" href=""><i class="ti-heart "><sup class="number_menu">0</sup></i> </a>
                <a class="nav-link active" href="">
                  <i class="ti-bag"><sup class="number_menu">0  </sup></i>
                  
                 </a>
                <span>$000</span>
                <a class="nav-link active" href=""><i class="ti-search"></i> </a>
            </div>

            <div class="navigater">
                <a href="#">HOME</a>
                <a href="#">OUR PRODUCTS</a>
                <a href="#">ABOUT US</a>
                <a href="#">BLOG</a>
                <a href="#">CLIENT CENTER</a>
                <a href="#">FAQ</a>
            </div>

            <div class="below">
                <li class="list-nav__item l ist-nav__item__icon "><a href="#">Our stores </a></li>
                <li class="list-nav__item l ist-nav__item__icon "><a href="#">Useful info </a></li>
                <li class="list-nav__item l ist-nav__item__icon "><a href="#">Help </a></li>
            </div>
        </div>
     </div>
     <div class="footer-mobile">
        <div class="row" style="height: 100%;">
            <div class="col-12 d-flex align-items-center justify-content-around">
                <div class="footer-mobile__item">
                    <i class="fa-solid fa-users-viewfinder"></i>
                </div>
                <div class="footer-mobile__item">
                    <i class="fa-regular fa-user"></i>
                </div>
                <div class="footer-mobile__item">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span class="number">0</span>
                </div>
                <div class="footer-mobile__item">
                    <i class="fa-regular fa-heart"></i>
                    <span class="number">0</span>
                </div>
            </div>
        </div>
     </div>

  </body>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/eventemitter2@6/lib/eventemitter2.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js"></script> 
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <!-- <script src="./js/home.js"></script>  -->
  <script>
    var foodCell1 = document.getElementById("food1");
    var foodCell2 = document.getElementById("food2");
    var foodCell3= document.getElementById("food3");
    var foodCell4= document.getElementById("food4");

    var priceCell1=document.getElementById('price1');
    var priceCell2=document.getElementById('price2');
    var priceCell3=document.getElementById('price3');
    var priceCell4=document.getElementById('price4');
   
     //ket noi toi ros
  var ros = new ROSLIB.Ros({
   // url : 'ws://192.168.1.10:9090'
    url : 'ws://192.168.1.143:9090'
  });

  ros.on('connection', function() {
    console.log('Connected to websocket server.');
  });

  ros.on('error', function(error) {
    console.log('Error connecting to websocket server: ', error);
  });

  ros.on('close', function() {
    console.log('Connection to websocket server closed.');
  });


  var actionClient = new ROSLIB.ActionClient({
    ros : ros,
    serverName : '/move_base',
    actionName : 'move_base_msgs/MoveBaseAction'
  });

    
  function sendGoal(m,n,p,q) {
    var positionVec3 = new ROSLIB.Vector3(null);
    var orientation = new ROSLIB.Quaternion({x:0, y:0, z:p, w:q});
    
    positionVec3.x = m;
    positionVec3.y = n;

    var pose = new ROSLIB.Pose({
      position : positionVec3,
      orientation : orientation
    });

    var goal = new ROSLIB.Goal({
        actionClient : actionClient,
        goalMessage : {
          target_pose : {
            header : {
              frame_id :'map'
            },
            pose : pose
          }
        }
      });
      goal.send();
  }

  function cancelGoal() {
    // cancel the current goal
    goal.cancel();
  }

 
    var text_data;
    const topic = new ROSLIB.Topic({
    ros: ros,
    name: '/my_topic',
    messageType: 'std_msgs/String'
  });

  // Đăng ký lắng nghe dữ liệu từ topic
   topic.subscribe(function(message) {
    text_data=(message.data).toString();
    console.log('Nhận dữ liệu từ topic:', message.data);

   var arrayData=text_data.split(";");
   var SoBan= arrayData[0];
   var FoodNames=arrayData[1];
   var TongTien=arrayData[2];
   console.log("dulieu"+SoBan,FoodNames,TongTien);
   if(SoBan=="1"){
       foodCell1.textContent=FoodNames;
       priceCell1.textContent=TongTien;

   }
   if(SoBan=="2"){
       foodCell2.textContent=FoodNames;
       priceCell2.textContent=TongTien;

   }
   if(SoBan=="3"){
       foodCell3.textContent=FoodNames;
       priceCell3.textContent=TongTien;

   }
   if(SoBan=="4"){
       foodCell4.textContent=FoodNames;
       priceCell4.textContent=TongTien;

   }
  })






 //tạo queue lưu vị trí giao đồ ăn
  class Queue {
    constructor() {
     this.items = [];
  }

    enqueue(element) {
     this.items.push(element);
    }

    dequeue() {
     if (this.isEmpty()) {
      return "Queue is empty";
    }
     return this.items.shift();
  }

     front() {
     if (this.isEmpty()) {
      return "Queue is empty";
     }
     return this.items[0];
  }

     isEmpty() {
      return this.items.length === 0;
  }

     size() {
     return this.items.length;
   }
}

  // Sử dụng hàng đợi trong quá trình thực thi chương trình

   const queue = new Queue();



    //Monitoring /move_base/result
    var move_baseListener1 = new ROSLIB.Topic({
    ros : ros,
    name : '/move_base/result',
    messageType : 'move_base_msgs/MoveBaseActionResult'
    });
   
    move_baseListener1.subscribe(function(actionResult) {
      if(actionResult.status.status==3&& data_xacnhan=="0"){
        alert("Đồ ăn đã được giao");
        
       // move_baseListener.unsubscribe();
       
      }else if(actionResult.status.status==3 && data_xacnhan=="Finish"){
        alert("XE ĐÃ VỀ QUẦY");
      }

      
    });
   

 function GiaoDoAn()
 {   //datta xac nhan cua khach hang
 

    

  
    //console.log(data_xacnhan);
      if(data_xacnhan=="1"&& queue.size()!=0)
      { 
        let ViTriGiao=queue.dequeue();
         sendGoal(ViTriGiao[0],ViTriGiao[1],ViTriGiao[2],ViTriGiao[3]);
         data_xacnhan="0";
         danggiao=0;
         console.log("danggiao")
      }
     
  
     


    

       // actionResult.status.status == 2 (goal cancelled)
        // actionResult.status.status == 3 (goal reached)
       

        //  if(queue.isEmpty()=true){
        //     //tro ve vi tri HOme
         //     sendGoal(-1.1174,3.0668,-0.7071,0.7071);
         //   }
       

  
   //GiaoDoAn();
 }

   //0.9,2.07,0.7071,-0.7071;2.2227,-0.2534,0.7071,-0.7071 ; 3.4391,2.0294,0.7071,-0.7071 ; 4.4998,-0.1727,0.7071,-0.7071
 
  // Lấy và xóa phần tử đầu tiên trong hàng đợi
  // const nextDestination = queue.dequeue();
  // console.log(nextDestination); // Output: "Vị trí A"

  // // Lấy phần tử đầu tiên trong hàng đợi (không xóa)
  // const frontDestination = queue.front();
  // console.log(frontDestination); // Output: "Vị trí B"

  // //  Kiểm tra xem hàng đợi có rỗng hay không
  // console.log(queue.isEmpty()); // Output: false

  //  // Kiểm tra kích thước của hàng đợi
  // console.log(queue.size()); // Output: 2
  

  //hàm chuyển vị trí robot khi ấn vào nút xác nhận

  function xacnhan(a,b,c,d){
    queue.enqueue([a,b,c,d]);
    console.log(queue);

  }


  //viết hàm logic mlowis

  function sengoal_tong(x){
    switch (x) {
  case 1:
    sendGoal(0.9,2.017,0.7071,-0.7071);
    console.log("danggiaodenbandautien")
    break;
  case 2:
    sendGoal(2.2227,-0.2534,0.7071,-0.7071)
    break;
  case 3:
    sendGoal(3.4391,2.0294,0.7071,-0.7071)
    break;
  case 4:
    sendGoal(4.4998,-0.1727,0.7071,-0.7071)
    break;
  // Nếu không khớp với bất kỳ trường hợp nào trên, sẽ thực hiện default (nếu có)
  default:
    sendGoal(-1.1174,3.0668,-0.7071,0.7071);
    break;
}
}
   var thutuban=[];
   var thutuban_clone=[];

   function xacnhan1(x){
   thutuban.push(x);
   console.log(x);
   thutuban_clone.push(x);

  }

  //Gioa do1
  function giaodo1(){


    fist_thutuban=thutuban.shift();
    sengoal_tong(fist_thutuban);
    console.log(fist_thutuban);

    var text_ban=thutuban.join(",");

    const topic4 = new ROSLIB.Topic({
     ros: ros,
     name: '/my_topic4', // Tên của topic trong ROS
     messageType: 'std_msgs/String' // Kiểu dữ liệu của topic
     });

         // Tạo một message và gửi nó xuống topic
    const message = new ROSLIB.Message({
     data:text_ban // Dữ liệu bạn muốn gửi
    });
    topic4.publish(message);
    thutuban=[];
  }

   var data_xacnhan="0";

    const topic3 = new ROSLIB.Topic({
    ros: ros,
    name: '/my_topic2',
    messageType: 'std_msgs/String'
    });
         // Đăng ký lắng nghe dữ liệu từ topic
    topic3.subscribe(function(message) {
    data_xacnhan=(message.data);
    console.log(data_xacnhan);
    if(data_xacnhan=="Finish"||thutuban_clone.length==1){
     for(i=0;i<thutuban_clone.length;i++){


      switch (thutuban_clone[i]) {
       case 1:
       foodCell1.textContent="Đã Giao Xong";
    
        break;
       case 2:
       foodCell2.textContent="Đã Giao Xong";
         break;
       case 3:
      foodCell3.textContent="Đã Giao Xong";
        break;
       case 4:
       foodCell4.textContent="Đã Giao Xong";
         break;
     }
     data_xacnhan="0";
     } 
     thutuban_clone=[];
    }


   
   })


  </script>



</html> 